// Module: swave.obj
// Source: C:\Copter\source\sparkal\swave.cpp
// autogenerated by simcopter_tool from PDB file

// Type: char *;

// Type: void * __ptr32;

// Type: struct tWAVEFORMATEX (forward reference);

// Type: struct _MMCKINFO (forward reference);

// Type: unsigned short;

// Type: struct pcmwaveformat_tag;
class pcmwaveformat_tag{
public:
	struct waveformat_tag wf;
	unsigned short wBitsPerSample;
};

// Type: struct _MMCKINFO;
class _MMCKINFO{
public:
	unsigned long ckid;
	unsigned long cksize;
	unsigned long fccType;
	unsigned long dwDataOffset;
	unsigned long dwFlags;
};

// Type: int32_t;

// Type: uint32_t;

// Type: unsigned char *;

// Type: uint32_t *;

// Type: struct _MMIOINFO;
class _MMIOINFO{
public:
	unsigned long dwFlags;
	unsigned long fccIOProc;
	long (*)(char *, uint32_t, long, long) pIOProc;
	uint32_t wErrorRet;
	void * __ptr32 htask;
	long cchBuffer;
	char * pchBuffer;
	char * pchNext;
	char * pchEndRead;
	char * pchEndWrite;
	long lBufOffset;
	long lDiskOffset;
	unsigned long[3] adwInfo;
	unsigned long dwReserved1;
	unsigned long dwReserved2;
	void * __ptr32 hmmio;
};



// Contribution: 1:0008dbb0-0008e11e Module: 25, 16 byte alignment, code, execute, read, 
// FUNCTION: COPTER_D 0x0048ebb0
int32_t WaveOpenFile(char * pszFileName, void * __ptr32* phmmioIn, struct tWAVEFORMATEX* pwfxInfo, struct _MMCKINFO* pckInRIFF) {
	unsigned short cbExtraAlloc;
	struct pcmwaveformat_tag pcmWaveFormat;
	void * __ptr32 hmmioIn;
	struct _MMCKINFO ckIn;
	int32_t nError;

// LINE 48:
	__asm        push   ebp;
	__asm        mov    ebp, esp;
	__asm        sub    esp, 0x30;
	__asm        push   ebx;
	__asm        push   esi;
	__asm        push   edi;
// LINE 49:
	__asm        mov    hmmioIn, 0;
// LINE 53:
	__asm        mov    nError, 0;
// LINE 61:
	__asm        push   0x10000;
	__asm        push   0;
	__asm        mov    eax, pszFileName;
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C38F4];
	__asm        mov    hmmioIn, eax;
	__asm        cmp    hmmioIn, 0;
	__asm        jne    near ptr 0x0048EBF6;
// LINE 62:
	__asm        mov    nError, 0xE100;
// LINE 63:
	__asm        jmp    near ptr 0x0048EDAF;
	__asm        jmp    near ptr 0x0048ED5A;
// LINE 67:
	__asm        push   0;
	__asm        push   0;
	__asm        mov    eax, pckInRIFF;
	__asm        push   eax;
	__asm        mov    eax, hmmioIn;
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C3904];
	__asm        mov    nError, eax;
	__asm        cmp    nError, 0;
	__asm        je     near ptr 0x0048EC1F;
// LINE 68:
	__asm        jmp    near ptr 0x0048EDAA;
	__asm        jmp    near ptr 0x0048ED5A;
// LINE 70:
	__asm        mov    eax, pckInRIFF;
	__asm        cmp    dword ptr [eax], 0x46464952;
	__asm        jne    near ptr 0x0048EC3E;
	__asm        mov    eax, pckInRIFF;
	__asm        cmp    dword ptr [eax+8], 0x45564157;
	__asm        je     near ptr 0x0048EC4F;
// LINE 71:
	__asm        mov    nError, 0xE101;
// LINE 72:
	__asm        jmp    near ptr 0x0048EDA5;
	__asm        jmp    near ptr 0x0048ED5A;
// LINE 76:
	__asm        mov    ckIn.ckid, 0x20746D66;
// LINE 77:
	__asm        push   0x10;
	__asm        mov    eax, pckInRIFF;
	__asm        push   eax;
	__asm        lea    eax, ckIn.ckid;
	__asm        push   eax;
	__asm        mov    eax, hmmioIn;
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C3904];
	__asm        mov    nError, eax;
	__asm        cmp    nError, 0;
	__asm        je     near ptr 0x0048EC81;
// LINE 78:
	__asm        jmp    near ptr 0x0048EDA0;
	__asm        jmp    near ptr 0x0048ED5A;
// LINE 83:
	__asm        cmp    ckIn.cksize, 0x10;
	__asm        jae    near ptr 0x0048EC9C;
// LINE 84:
	__asm        mov    nError, 0xE101;
// LINE 85:
	__asm        jmp    near ptr 0x0048ED9B;
	__asm        jmp    near ptr 0x0048ED5A;
// LINE 89:
	__asm        push   0x10;
	__asm        lea    eax, pcmWaveFormat.wf.wFormatTag;
	__asm        push   eax;
	__asm        mov    eax, hmmioIn;
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C38F8];
	__asm        cmp    eax, 0x10;
	__asm        je     near ptr 0x0048ECC6;
// LINE 90:
	__asm        mov    nError, 0xE102;
// LINE 91:
	__asm        jmp    near ptr 0x0048ED96;
	__asm        jmp    near ptr 0x0048ED5A;
// LINE 98:
	__asm        mov    eax, reinterpret_cast<uint32_t>(pcmWaveFormat.wf.wFormatTag);
	__asm        and    eax, 0xFFFF;
	__asm        cmp    eax, 1;
	__asm        jne    near ptr 0x0048ECE2;
// LINE 99:
	__asm        mov    cbExtraAlloc, 0;
// LINE 101:
	__asm        jmp    near ptr 0x0048ED0C;
// LINE 103:
	__asm        push   2;
	__asm        lea    eax, cbExtraAlloc;
	__asm        push   eax;
	__asm        mov    eax, hmmioIn;
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C38F8];
	__asm        cmp    eax, 2;
	__asm        je     near ptr 0x0048ED0C;
// LINE 104:
	__asm        mov    nError, 0xE102;
// LINE 105:
	__asm        jmp    near ptr 0x0048ED91;
	__asm        jmp    near ptr 0x0048ED5A;
// LINE 110:
	__asm        push   0x10;
	__asm        lea    eax, pcmWaveFormat.wf.wFormatTag;
	__asm        push   eax;
	__asm        mov    eax, pwfxInfo;
	__asm        push   eax;
	__asm        call   0x0056A800;
	__asm        add    esp, 0xC;
// LINE 111:
	__asm        mov    ax, cbExtraAlloc;
	__asm        mov    ecx, pwfxInfo;
	__asm        mov    [ecx+0x10], ax;
// LINE 126:
	__asm        push   0;
	__asm        lea    eax, ckIn.ckid;
	__asm        push   eax;
	__asm        mov    eax, hmmioIn;
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C38FC];
	__asm        mov    nError, eax;
	__asm        cmp    nError, 0;
	__asm        je     near ptr 0x0048ED50;
// LINE 127:
	__asm        jmp    near ptr 0x0048ED8C;
	__asm        jmp    near ptr 0x0048ED5A;
// LINE 129:
	__asm        jmp    near ptr 0x0048ED87;
	__asm        jmp    near ptr 0x0048ED77;
// LINE 132:
ERROR_READING_WAVE:
	__asm        cmp    hmmioIn, 0;
	__asm        je     near ptr 0x0048ED77;
// LINE 133:
	__asm        push   0;
	__asm        mov    eax, hmmioIn;
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C391C];
// LINE 134:
	__asm        mov    hmmioIn, 0;
// LINE 138:
END_OF_ROUTINE:
	__asm        mov    eax, hmmioIn;
	__asm        mov    ecx, phmmioIn;
	__asm        mov    [ecx], eax;
// LINE 140:
	__asm        mov    eax, nError;
	__asm        jmp    near ptr 0x0048EDB4;
// LINE 141:
	__asm        jmp    near ptr 0x0048ED77;
	__asm        jmp    near ptr 0x0048ED5A;
	__asm        jmp    near ptr 0x0048ED5A;
	__asm        jmp    near ptr 0x0048ED5A;
	__asm        jmp    near ptr 0x0048ED5A;
	__asm        jmp    near ptr 0x0048ED5A;
	__asm        jmp    near ptr 0x0048ED5A;
	__asm        jmp    near ptr 0x0048ED5A;
	__asm        jmp    near ptr 0x0048ED5A;
	__asm        pop    edi;
	__asm        pop    esi;
	__asm        pop    ebx;
	__asm        leave;
	__asm        ret;
}

// FUNCTION: COPTER_D 0x0048edb9
int32_t WaveStartDataRead(void * __ptr32* phmmioIn, struct _MMCKINFO* pckIn, struct _MMCKINFO* pckInRIFF) {
	int32_t nError;

// LINE 157:
	__asm        push   ebp;
	__asm        mov    ebp, esp;
	__asm        sub    esp, 4;
	__asm        push   ebx;
	__asm        push   esi;
	__asm        push   edi;
// LINE 160:
	__asm        push   0;
	__asm        mov    eax, pckInRIFF;
	__asm        mov    eax, [eax+0xC];
	__asm        add    eax, 4;
	__asm        push   eax;
	__asm        mov    eax, phmmioIn;
	__asm        mov    eax, [eax];
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C3900];
	__asm        mov    nError, eax;
	__asm        cmp    nError, 0xFFFFFFFF;
	__asm        jne    near ptr 0x0048EDF1;
// LINE 161:
	__asm        jmp    near ptr 0x0048EE1B;
	__asm        jmp    near ptr 0x0048EE13;
// LINE 164:
	__asm        mov    eax, pckIn;
	__asm        mov    dword ptr [eax], 0x61746164;
// LINE 165:
	__asm        push   0x10;
	__asm        mov    eax, pckInRIFF;
	__asm        push   eax;
	__asm        mov    eax, pckIn;
	__asm        push   eax;
	__asm        mov    eax, phmmioIn;
	__asm        mov    eax, [eax];
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C3904];
	__asm        mov    nError, eax;
// LINE 168:
ERROR_READING_WAVE:
	__asm        mov    eax, nError;
	__asm        jmp    near ptr 0x0048EE20;
// LINE 169:
	__asm        jmp    near ptr 0x0048EE13;
	__asm        pop    edi;
	__asm        pop    esi;
	__asm        pop    ebx;
	__asm        leave;
	__asm        ret;
}

// FUNCTION: COPTER_D 0x0048ee25
int32_t WaveReadFile(void * __ptr32 hmmioIn, uint32_t cbRead, unsigned char * pbDest, struct _MMCKINFO* pckIn, uint32_t * cbActualRead) {
	struct _MMIOINFO mmioinfoIn;
	uint32_t cT;
	int32_t nError;
	unsigned char * tempBYTEPointerToFoolCrappyMicrosoftCompiler;

// LINE 191:
	__asm        push   ebp;
	__asm        mov    ebp, esp;
	__asm        sub    esp, 0x54;
	__asm        push   ebx;
	__asm        push   esi;
	__asm        push   edi;
// LINE 197:
	__asm        push   0;
	__asm        lea    eax, mmioinfoIn.dwFlags;
	__asm        push   eax;
	__asm        mov    eax, hmmioIn;
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C38E8];
	__asm        mov    nError, eax;
// LINE 199:
	__asm        cmp    nError, 0;
	__asm        je     near ptr 0x0048EE55;
// LINE 200:
	__asm        jmp    near ptr 0x0048EF65;
	__asm        jmp    near ptr 0x0048EF40;
// LINE 203:
	__asm        mov    eax, pckIn;
	__asm        mov    ecx, cbRead;
	__asm        cmp    [eax+4], ecx;
	__asm        jae    near ptr 0x0048EE6D;
// LINE 204:
	__asm        mov    eax, pckIn;
	__asm        mov    eax, [eax+4];
	__asm        mov    cbRead, eax;
// LINE 206:
	__asm        xor    eax, eax;
	__asm        sub    eax, cbRead;
	__asm        neg    eax;
	__asm        mov    ecx, pckIn;
	__asm        sub    [ecx+4], eax;
// LINE 208:
	__asm        mov    cT, 0;
	__asm        jmp    near ptr 0x0048EE89;
	__asm        inc    cT;
	__asm        mov    eax, cbRead;
	__asm        cmp    cT, eax;
	__asm        jae    near ptr 0x0048EF07;
// LINE 210:
	__asm        mov    eax, mmioinfoIn.pchEndRead;
	__asm        cmp    mmioinfoIn.pchNext, eax;
	__asm        jne    near ptr 0x0048EEE5;
// LINE 211:
	__asm        push   0;
	__asm        lea    eax, mmioinfoIn.dwFlags;
	__asm        push   eax;
	__asm        mov    eax, hmmioIn;
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C38EC];
	__asm        mov    nError, eax;
	__asm        cmp    nError, 0;
	__asm        je     near ptr 0x0048EEC8;
// LINE 212:
	__asm        jmp    near ptr 0x0048EF60;
	__asm        jmp    near ptr 0x0048EF40;
// LINE 214:
	__asm        mov    eax, mmioinfoIn.pchEndRead;
	__asm        cmp    mmioinfoIn.pchNext, eax;
	__asm        jne    near ptr 0x0048EEE5;
// LINE 215:
	__asm        mov    nError, 0xE103;
// LINE 216:
	__asm        jmp    near ptr 0x0048EF5B;
	__asm        jmp    near ptr 0x0048EF40;
// LINE 222:
	__asm        mov    eax, mmioinfoIn.pchNext;
	__asm        mov    al, [eax];
	__asm        mov    ecx, cT;
	__asm        mov    edx, pbDest;
	__asm        mov    [ecx+edx], al;
// LINE 223:
	__asm        mov    eax, mmioinfoIn.pchNext;
	__asm        mov    tempBYTEPointerToFoolCrappyMicrosoftCompiler, eax;
// LINE 224:
	__asm        inc    tempBYTEPointerToFoolCrappyMicrosoftCompiler;
// LINE 225:
	__asm        mov    eax, tempBYTEPointerToFoolCrappyMicrosoftCompiler;
	__asm        mov    mmioinfoIn.pchNext, eax;
// LINE 226:
	__asm        jmp    near ptr 0x0048EE86;
// LINE 228:
	__asm        push   0;
	__asm        lea    eax, mmioinfoIn.dwFlags;
	__asm        push   eax;
	__asm        mov    eax, hmmioIn;
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C38F0];
	__asm        mov    nError, eax;
	__asm        cmp    nError, 0;
	__asm        je     near ptr 0x0048EF2E;
// LINE 229:
	__asm        jmp    near ptr 0x0048EF56;
	__asm        jmp    near ptr 0x0048EF40;
// LINE 231:
	__asm        mov    eax, cbRead;
	__asm        mov    ecx, cbActualRead;
	__asm        mov    [ecx], eax;
// LINE 232:
	__asm        jmp    near ptr 0x0048EF51;
	__asm        jmp    near ptr 0x0048EF49;
// LINE 235:
ERROR_CANNOT_READ:
	__asm        mov    eax, cbActualRead;
	__asm        mov    dword ptr [eax], 0;
// LINE 238:
FINISHED_READING:
	__asm        mov    eax, nError;
	__asm        jmp    near ptr 0x0048EF6A;
// LINE 239:
	__asm        jmp    near ptr 0x0048EF49;
	__asm        jmp    near ptr 0x0048EF40;
	__asm        jmp    near ptr 0x0048EF40;
	__asm        jmp    near ptr 0x0048EF40;
	__asm        jmp    near ptr 0x0048EF40;
	__asm        pop    edi;
	__asm        pop    esi;
	__asm        pop    ebx;
	__asm        leave;
	__asm        ret;
}

// FUNCTION: COPTER_D 0x0048ef6f
int32_t WaveCloseReadFile(void * __ptr32* phmmio) {
// LINE 251:
	__asm        push   ebp;
	__asm        mov    ebp, esp;
	__asm        push   ebx;
	__asm        push   esi;
	__asm        push   edi;
// LINE 252:
	__asm        mov    eax, phmmio;
	__asm        cmp    dword ptr [eax], 0;
	__asm        je     near ptr 0x0048EF98;
// LINE 253:
	__asm        push   0;
	__asm        mov    eax, phmmio;
	__asm        mov    eax, [eax];
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C391C];
// LINE 254:
	__asm        mov    eax, phmmio;
	__asm        mov    dword ptr [eax], 0;
// LINE 257:
	__asm        xor    eax, eax;
	__asm        jmp    near ptr 0x0048EF9F;
// LINE 258:
	__asm        pop    edi;
	__asm        pop    esi;
	__asm        pop    ebx;
	__asm        leave;
	__asm        ret;
}

// FUNCTION: COPTER_D 0x0048efa4
int32_t WaveLoadFile(char * pszFileName, uint32_t * cbSize, struct tWAVEFORMATEX* pwfxInfo, unsigned char ** ppbData) {
	uint32_t cbActualRead;
	void * __ptr32 hmmioIn;
	struct _MMCKINFO ckInRiff;
	struct _MMCKINFO ckIn;
	int32_t nError;

// LINE 278:
	__asm        push   ebp;
	__asm        mov    ebp, esp;
	__asm        sub    esp, 0x34;
	__asm        push   ebx;
	__asm        push   esi;
	__asm        push   edi;
// LINE 285:
	__asm        mov    eax, ppbData;
	__asm        mov    dword ptr [eax], 0;
// LINE 286:
	__asm        mov    eax, cbSize;
	__asm        mov    dword ptr [eax], 0;
// LINE 288:
	__asm        lea    eax, ckInRiff.ckid;
	__asm        push   eax;
	__asm        mov    eax, pwfxInfo;
	__asm        push   eax;
	__asm        lea    eax, hmmioIn;
	__asm        push   eax;
	__asm        mov    eax, pszFileName;
	__asm        push   eax;
	__asm        call   0x0048EBB0;
	__asm        add    esp, 0x10;
	__asm        mov    nError, eax;
	__asm        cmp    nError, 0;
	__asm        je     near ptr 0x0048EFEE;
// LINE 289:
	__asm        jmp    near ptr 0x0048F115;
	__asm        jmp    near ptr 0x0048F0B6;
// LINE 294:
	__asm        push   0;
	__asm        mov    eax, ckInRiff.dwDataOffset;
	__asm        add    eax, 4;
	__asm        push   eax;
	__asm        mov    eax, hmmioIn;
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C3900];
	__asm        cmp    eax, 0xFFFFFFFF;
	__asm        jne    near ptr 0x0048F014;
// LINE 295:
	__asm        jmp    near ptr 0x0048F110;
	__asm        jmp    near ptr 0x0048F0B6;
// LINE 298:
	__asm        mov    ckIn.ckid, 0x61746164;
// LINE 299:
	__asm        push   0x10;
	__asm        lea    eax, ckInRiff.ckid;
	__asm        push   eax;
	__asm        lea    eax, ckIn.ckid;
	__asm        push   eax;
	__asm        mov    eax, hmmioIn;
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C3904];
	__asm        test   eax, eax;
	__asm        je     near ptr 0x0048F041;
// LINE 300:
	__asm        jmp    near ptr 0x0048F10B;
	__asm        jmp    near ptr 0x0048F0B6;
// LINE 303:
	__asm        mov    eax, ckIn.cksize;
	__asm        push   eax;
	__asm        push   0;
	__asm        call   dword ptr ds:[0x6C3730];
	__asm        mov    ecx, ppbData;
	__asm        mov    [ecx], eax;
	__asm        mov    eax, ppbData;
	__asm        cmp    dword ptr [eax], 0;
	__asm        jne    near ptr 0x0048F06F;
// LINE 304:
	__asm        mov    nError, 0xE000;
// LINE 305:
	__asm        jmp    near ptr 0x0048F106;
	__asm        jmp    near ptr 0x0048F0B6;
// LINE 311:
	__asm        lea    eax, cbActualRead;
	__asm        push   eax;
	__asm        lea    eax, ckIn.ckid;
	__asm        push   eax;
	__asm        mov    eax, ppbData;
	__asm        mov    eax, [eax];
	__asm        push   eax;
	__asm        mov    eax, ckIn.cksize;
	__asm        push   eax;
	__asm        mov    eax, hmmioIn;
	__asm        push   eax;
	__asm        call   0x0048EE25;
	__asm        add    esp, 0x14;
	__asm        mov    nError, eax;
	__asm        cmp    nError, 0;
	__asm        je     near ptr 0x0048F0A4;
// LINE 312:
	__asm        jmp    near ptr 0x0048F101;
	__asm        jmp    near ptr 0x0048F0B6;
// LINE 315:
	__asm        mov    eax, cbActualRead;
	__asm        mov    ecx, cbSize;
	__asm        mov    [ecx], eax;
// LINE 316:
	__asm        jmp    near ptr 0x0048F0FC;
	__asm        jmp    near ptr 0x0048F0D7;
// LINE 319:
ERROR_LOADING:
	__asm        mov    eax, ppbData;
	__asm        cmp    dword ptr [eax], 0;
	__asm        je     near ptr 0x0048F0D7;
// LINE 320:
	__asm        mov    eax, ppbData;
	__asm        mov    eax, [eax];
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C3650];
// LINE 321:
	__asm        mov    eax, ppbData;
	__asm        mov    dword ptr [eax], 0;
// LINE 326:
DONE_LOADING:
	__asm        cmp    hmmioIn, 0;
	__asm        je     near ptr 0x0048F0F4;
// LINE 327:
	__asm        push   0;
	__asm        mov    eax, hmmioIn;
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C391C];
// LINE 328:
	__asm        mov    hmmioIn, 0;
// LINE 331:
	__asm        mov    eax, nError;
	__asm        jmp    near ptr 0x0048F11A;
// LINE 332:
	__asm        jmp    near ptr 0x0048F0D7;
	__asm        jmp    near ptr 0x0048F0B6;
	__asm        jmp    near ptr 0x0048F0B6;
	__asm        jmp    near ptr 0x0048F0B6;
	__asm        jmp    near ptr 0x0048F0B6;
	__asm        jmp    near ptr 0x0048F0B6;
	__asm        pop    edi;
	__asm        pop    esi;
	__asm        pop    ebx;
	__asm        leave;
	__asm        ret;
}

