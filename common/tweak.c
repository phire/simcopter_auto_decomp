// Module: Tweak.obj
// Source: C:\Copter\source\common\Tweak.c
// autogenerated by simcopter_tool from PDB file

// Type: int32_t *;

// Type: int32_t;

// Type: char *;

// Type: char[50];

// Type: char[300];

// Type: char[260];

// Type: void;

// Type: char[20];

// Type: char[15];



// Contribution: 1:000c8ad0-000c90b4 Module: 93, 16 byte alignment, code, execute, read, 
// FUNCTION: COPTER_D 0x004c9ad0
int32_t TWKEnQueue(int32_t ** pValues, int32_t nNumValues, char * pszSection) {
	int32_t nCt;

// LINE 43:
	__asm        cmp    dword ptr ds:[0x59B3A8], 0xC8;
	__asm        jle    near ptr 0x004C9AF3;
// LINE 44:
	__asm        mov    eax, 0xFFFFFF9B;
	__asm        jmp    near ptr 0x004C9B96;
// LINE 46:
	__asm        cmp    nNumValues, 0x32;
	__asm        jle    near ptr 0x004C9B07;
// LINE 47:
	__asm        mov    eax, 0xFFFFFF99;
	__asm        jmp    near ptr 0x004C9B96;
// LINE 49:
	__asm        mov    nCt, 0;
	__asm        jmp    near ptr 0x004C9B16;

	__asm        inc    nCt;
	__asm        mov    eax, nCt;
	__asm        cmp    nNumValues, eax;
	__asm        jle    near ptr 0x004C9B49;
// LINE 50:
	__asm        mov    eax, nCt;
	__asm        mov    ecx, pValues;
	__asm        mov    eax, [ecx+eax*4];
	__asm        mov    ecx, nCt;
	__asm        mov    edx, ds:[0x59B3A8];
	__asm        mov    ebx, edx;
	__asm        shl    edx, 8;
	__asm        sub    edx, ebx;
	__asm        sub    edx, ebx;
	__asm        mov    [edx+ecx*4+0x63A860], eax;
	__asm        jmp    near ptr 0x004C9B13;
// LINE 52:
	__asm        mov    eax, pszSection;
	__asm        push   eax;
	__asm        mov    eax, ds:[0x59B3A8];
	__asm        mov    ecx, eax;
	__asm        shl    eax, 8;
	__asm        sub    eax, ecx;
	__asm        sub    eax, ecx;
	__asm        add    eax, 0x63A860;
	__asm        add    eax, 0xCC;
	__asm        push   eax;
	__asm        call   strcpy;
	__asm        add    esp, 8;
// LINE 53:
	__asm        mov    eax, nNumValues;
	__asm        mov    ecx, ds:[0x59B3A8];
	__asm        mov    edx, ecx;
	__asm        shl    ecx, 8;
	__asm        sub    ecx, edx;
	__asm        sub    ecx, edx;
	__asm        mov    [ecx+0x63A928], eax;
// LINE 54:
	__asm        inc    dword ptr ds:[0x59B3A8];
// LINE 56:
	__asm        mov    eax, ds:[0x59B3A8];
	__asm        jmp    near ptr 0x004C9B96;
// LINE 57:
}

// FUNCTION: COPTER_D 0x004c9b9b
int32_t TWKReadFile(char * pszTWKFile, int32_t bIsOnMessageRead) {
	char szSection[50];
	int32_t nCt;
	char szTemp[300];
	char szFullPath[260];

// LINE 77:
	__asm        mov    dword ptr ds:[0x59B3AC], 0;
// LINE 78:
	__asm        lea    eax, szFullPath[0];
	__asm        push   eax;
	__asm        mov    eax, pszTWKFile;
	__asm        push   eax;
	__asm        push   0;
	__asm        push   0xB;
	__asm        call   GetPathForFile;
	__asm        add    esp, 0x10;
// LINE 80:
	__asm        lea    eax, szFullPath[0];
	__asm        push   eax;
	__asm        push   0x12C;
	__asm        lea    eax, szTemp[0];
	__asm        push   eax;
	__asm        push   0x59B3B0;
	__asm        push   0x59B3B4;
	__asm        push   0x59B3C0;
	__asm        call   dword ptr ds:[0x6C3618];
// LINE 81:
	__asm        cmp    bIsOnMessageRead, 0;
	__asm        je     near ptr 0x004C9D13;

	__asm        push   0x59B3D8;
	__asm        lea    eax, szTemp[0];
	__asm        push   eax;
	__asm        call   strcmp;
	__asm        add    esp, 8;
	__asm        test   eax, eax;
	__asm        je     near ptr 0x004C9D13;
// LINE 83:
	__asm        lea    eax, szFullPath[0];
	__asm        push   eax;
	__asm        push   0x32;
	__asm        lea    eax, szSection[0];
	__asm        push   eax;
	__asm        push   0x59B3DC;
	__asm        push   0x59B3F0;
	__asm        push   0x59B3FC;
	__asm        call   dword ptr ds:[0x6C3618];
// LINE 85:
	__asm        push   0x59B414;
	__asm        lea    eax, szSection[0];
	__asm        push   eax;
	__asm        call   strcmp;
	__asm        add    esp, 8;
	__asm        test   eax, eax;
	__asm        jne    near ptr 0x004C9C61;
// LINE 86:
	__asm        mov    eax, 0xFFFFFF9A;
	__asm        jmp    near ptr 0x004C9D29;
// LINE 88:
	__asm        mov    nCt, 0;
	__asm        jmp    near ptr 0x004C9C76;

	__asm        inc    nCt;
	__asm        mov    eax, nCt;
	__asm        cmp    ds:[0x59B3A8], eax;
	__asm        jle    near ptr 0x004C9CC3;
// LINE 89:
	__asm        lea    eax, szSection[0];
	__asm        push   eax;
	__asm        mov    eax, nCt;
	__asm        mov    ecx, eax;
	__asm        shl    eax, 8;
	__asm        sub    eax, ecx;
	__asm        sub    eax, ecx;
	__asm        add    eax, 0x63A860;
	__asm        add    eax, 0xCC;
	__asm        push   eax;
	__asm        call   strcmp;
	__asm        add    esp, 8;
	__asm        test   eax, eax;
	__asm        jne    near ptr 0x004C9CBE;
// LINE 90:
	__asm        jmp    near ptr 0x004C9CC3;
// LINE 92:
	__asm        jmp    near ptr 0x004C9C70;

	__asm        mov    eax, nCt;
	__asm        cmp    ds:[0x59B3A8], eax;
	__asm        je     near ptr 0x004C9D0E;
// LINE 93:
	__asm        mov    eax, nCt;
	__asm        push   eax;
	__asm        lea    eax, szSection[0];
	__asm        push   eax;
	__asm        lea    eax, szTemp[0];
	__asm        push   eax;
	__asm        call   TWKReadSection;
	__asm        add    esp, 0xC;
// LINE 95:
	__asm        lea    eax, szFullPath[0];
	__asm        push   eax;
	__asm        push   0x59B428;
	__asm        push   0x59B42C;
	__asm        push   0x59B438;
	__asm        call   dword ptr ds:[0x6C3794];
// LINE 98:
	__asm        jmp    near ptr 0x004C9D1F;
// LINE 99:
	__asm        mov    eax, pszTWKFile;
	__asm        push   eax;
	__asm        call   TWKReadAllFiles;
	__asm        add    esp, 4;
// LINE 104:
	__asm        mov    eax, ds:[0x59B3AC];
	__asm        jmp    near ptr 0x004C9D29;
// LINE 105:
}

// FUNCTION: COPTER_D 0x004c9d2e
void TWKGameInit() {
// LINE 117:
	__asm        push   0x59B450;
	__asm        call   dword ptr ds:[0x6C37E4];
	__asm        mov    ds:[0x646ED0], eax;
// LINE 119:
	__asm        mov    dword ptr ds:[0x59B3A8], 0;
// LINE 120:
	__asm        mov    dword ptr ds:[0x59B3AC], 0;
// LINE 121:
}

// FUNCTION: COPTER_D 0x004c9d5d
void TWKUpdate() {
// LINE 142:
}

// FUNCTION: COPTER_D 0x004c9d68
void TWKReadAllFiles(char * pszTWKFile) {
	char * pszSection;
	int32_t nCt;
	char szTemp[300];
	char szFullPath[260];
	char * pszFile;

// LINE 170:
	__asm        lea    eax, szFullPath[0];
	__asm        push   eax;
	__asm        mov    eax, pszTWKFile;
	__asm        push   eax;
	__asm        push   0;
	__asm        push   0xB;
	__asm        call   GetPathForFile;
	__asm        add    esp, 0x10;
// LINE 171:
	__asm        mov    nCt, 0;
	__asm        jmp    near ptr 0x004C9DA0;

	__asm        inc    nCt;
	__asm        mov    eax, nCt;
	__asm        cmp    ds:[0x59B3A8], eax;
	__asm        jle    near ptr 0x004C9E4A;
// LINE 172:
	__asm        mov    eax, nCt;
	__asm        mov    ecx, eax;
	__asm        shl    eax, 8;
	__asm        sub    eax, ecx;
	__asm        sub    eax, ecx;
	__asm        add    eax, 0x63A860;
	__asm        add    eax, 0xCC;
	__asm        mov    pszSection, eax;
// LINE 175:
	__asm        lea    eax, szFullPath[0];
	__asm        push   eax;
	__asm        push   0x12C;
	__asm        lea    eax, szTemp[0];
	__asm        push   eax;
	__asm        push   0x59B460;
	__asm        push   0x59B46C;
	__asm        mov    eax, pszSection;
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C3618];
// LINE 176:
	__asm        push   0x59B478;
	__asm        lea    eax, szTemp[0];
	__asm        push   eax;
	__asm        call   strcmp;
	__asm        add    esp, 8;
	__asm        test   eax, eax;
	__asm        je     near ptr 0x004C9E25;
// LINE 177:
	__asm        lea    eax, szTemp[0];
	__asm        mov    pszFile, eax;
// LINE 178:
	__asm        jmp    near ptr 0x004C9E2B;
// LINE 179:
	__asm        mov    eax, pszTWKFile;
	__asm        mov    pszFile, eax;
// LINE 184:
	__asm        mov    eax, nCt;
	__asm        push   eax;
	__asm        mov    eax, pszSection;
	__asm        push   eax;
	__asm        mov    eax, pszFile;
	__asm        push   eax;
	__asm        call   TWKReadSection;
	__asm        add    esp, 0xC;
// LINE 185:
	__asm        jmp    near ptr 0x004C9D9A;
// LINE 191:
}

// FUNCTION: COPTER_D 0x004c9e4f
void TWKReadSection(char * pszFile, char * pszSection, int32_t nTweakQueueSlotIdx) {
	char szKey[50];
	char szDataType[20];
	int32_t nNumCtrl;
	int32_t nCt2;
	char szFullPath[260];
	char szValue[15];

// LINE 211:
	__asm        push   0x59B484;
	__asm        push   0x59B48C;
	__asm        lea    eax, szKey[0];
	__asm        push   eax;
	__asm        call   sprintf;
	__asm        add    esp, 0xC;
// LINE 212:
	__asm        lea    eax, szFullPath[0];
	__asm        push   eax;
	__asm        mov    eax, pszFile;
	__asm        push   eax;
	__asm        push   0;
	__asm        push   0xB;
	__asm        call   GetPathForFile;
	__asm        add    esp, 0x10;
// LINE 213:
	__asm        lea    eax, szFullPath[0];
	__asm        push   eax;
	__asm        push   0xFFFFFF9A;
	__asm        lea    eax, szKey[0];
	__asm        push   eax;
	__asm        mov    eax, pszSection;
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C361C];
	__asm        mov    nNumCtrl, eax;
// LINE 214:
	__asm        cmp    nNumCtrl, 0xFFFFFF9A;
	__asm        je     near ptr 0x004CA03E;
// LINE 216:
	__asm        mov    nCt2, 0;
	__asm        jmp    near ptr 0x004C9ECD;

	__asm        inc    nCt2;
	__asm        mov    eax, nCt2;
	__asm        cmp    nNumCtrl, eax;
	__asm        jle    near ptr 0x004CA039;
// LINE 217:
	__asm        push   0x59B490;
	__asm        mov    eax, nCt2;
	__asm        push   eax;
	__asm        push   0x59B498;
	__asm        push   0x59B4A0;
	__asm        lea    eax, szKey[0];
	__asm        push   eax;
	__asm        call   sprintf;
	__asm        add    esp, 0x14;
// LINE 219:
	__asm        lea    eax, szFullPath[0];
	__asm        push   eax;
	__asm        push   0xF;
	__asm        lea    eax, szValue[0];
	__asm        push   eax;
	__asm        push   0x59B4A8;
	__asm        lea    eax, szKey[0];
	__asm        push   eax;
	__asm        mov    eax, pszSection;
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C3618];
// LINE 220:
	__asm        push   0x59B4BC;
	__asm        mov    eax, nCt2;
	__asm        push   eax;
	__asm        push   0x59B4C8;
	__asm        push   0x59B4D0;
	__asm        lea    eax, szKey[0];
	__asm        push   eax;
	__asm        call   sprintf;
	__asm        add    esp, 0x14;
// LINE 222:
	__asm        lea    eax, szFullPath[0];
	__asm        push   eax;
	__asm        push   0x14;
	__asm        lea    eax, szDataType[0];
	__asm        push   eax;
	__asm        push   0x59B4D8;
	__asm        lea    eax, szKey[0];
	__asm        push   eax;
	__asm        mov    eax, pszSection;
	__asm        push   eax;
	__asm        call   dword ptr ds:[0x6C3618];
// LINE 225:
	__asm        push   0x59B4E8;
	__asm        lea    eax, szDataType[0];
	__asm        push   eax;
	__asm        call   strcmp;
	__asm        add    esp, 8;
	__asm        test   eax, eax;
	__asm        jne    near ptr 0x004C9FC5;
// LINE 226:
	__asm        lea    eax, szValue[0];
	__asm        push   eax;
	__asm        call   atof;
	__asm        add    esp, 4;
	__asm        fmul   qword ptr ds:[0x5923E0];
	__asm        call   0x0056EBE8;
	__asm        mov    ecx, nCt2;
	__asm        mov    edx, nTweakQueueSlotIdx;
	__asm        mov    ebx, edx;
	__asm        shl    edx, 8;
	__asm        sub    edx, ebx;
	__asm        sub    edx, ebx;
	__asm        mov    ecx, [edx+ecx*4+0x63A860];
	__asm        mov    [ecx], eax;
// LINE 227:
	__asm        jmp    near ptr 0x004CA034;
// LINE 228:
	__asm        push   0x59B4F0;
	__asm        lea    eax, szDataType[0];
	__asm        push   eax;
	__asm        call   strcmp;
	__asm        add    esp, 8;
	__asm        test   eax, eax;
	__asm        jne    near ptr 0x004CA00D;
// LINE 229:
	__asm        lea    eax, szValue[0];
	__asm        push   eax;
	__asm        call   atof;
	__asm        add    esp, 4;
	__asm        mov    eax, nCt2;
	__asm        mov    ecx, nTweakQueueSlotIdx;
	__asm        mov    edx, ecx;
	__asm        shl    ecx, 8;
	__asm        sub    ecx, edx;
	__asm        sub    ecx, edx;
	__asm        mov    eax, [ecx+eax*4+0x63A860];
	__asm        fstp   qword ptr [eax];
// LINE 230:
	__asm        jmp    near ptr 0x004CA034;
// LINE 231:
	__asm        lea    eax, szValue[0];
	__asm        push   eax;
	__asm        call   atoi;
	__asm        add    esp, 4;
	__asm        mov    ecx, nCt2;
	__asm        mov    edx, nTweakQueueSlotIdx;
	__asm        mov    ebx, edx;
	__asm        shl    edx, 8;
	__asm        sub    edx, ebx;
	__asm        sub    edx, ebx;
	__asm        mov    ecx, [edx+ecx*4+0x63A860];
	__asm        mov    [ecx], eax;
// LINE 232:
	__asm        jmp    near ptr 0x004C9EC7;
// LINE 234:
	__asm        jmp    near ptr 0x004CA054;
// LINE 245:
	__asm        mov    eax, nTweakQueueSlotIdx;
	__asm        mov    ecx, ds:[0x59B3AC];
	__asm        mov    [ecx*4+0x646EE0], eax;
// LINE 246:
	__asm        inc    dword ptr ds:[0x59B3AC];
// LINE 249:
}

// FUNCTION: COPTER_D 0x004ca059
int32_t TWKDOSRead(char * pszTWKFile) {
// LINE 265:
	__asm        mov    eax, ds:[0x59B3AC];
	__asm        jmp    near ptr 0x004CA069;
// LINE 352:
}

// FUNCTION: COPTER_D 0x004ca06e
void TWKGetToEOLN(char * pDest, char * pSource) {
	int32_t nCt;

// LINE 362:
	__asm        mov    nCt, 0;
// LINE 363:
	__asm        mov    eax, pSource;
	__asm        movsx  eax, byte ptr [eax];
	__asm        cmp    eax, 0xD;
	__asm        je     near ptr 0x004CA0A6;
// LINE 364:
	__asm        mov    eax, pSource;
	__asm        mov    al, [eax];
	__asm        mov    ecx, nCt;
	__asm        mov    edx, pDest;
	__asm        mov    [ecx+edx], al;
// LINE 365:
	__asm        inc    pSource;
// LINE 366:
	__asm        inc    nCt;
// LINE 367:
	__asm        jmp    near ptr 0x004CA07E;
// LINE 368:
	__asm        mov    eax, nCt;
	__asm        mov    ecx, pDest;
	__asm        mov    byte ptr [eax+ecx], 0;
// LINE 369:
}



// Contribution: 2:000033e0-000033e7 Module: 93, 8 byte alignment, initialized_data, read, 


// Contribution: 3:000043a8-000044f6 Module: 93, 4 byte alignment, initialized_data, read, write, 
// GLOBAL: COPTER_D 0x0059b3a8
// g_nNextTWKQueueSlot
// GLOBAL: COPTER_D 0x0059b3ac
// g_nNextTWKErrorSlot


// Unknown globals:
// The PDB was slightly corrupted and we aren't sure which file these globals belong to.
// GLOBAL: COPTER_D 0x00646ee0
// _TWKErrorSlot
// GLOBAL: COPTER_D 0x0063a860
// _TWKQueue

// WARNING: this global might actually belong to: C:\Copter\source\common\S2lodsav.c
// GLOBAL: COPTER_D 0x0063a860
// TWKQueue
// GLOBAL: COPTER_D 0x00646ee0
// TWKErrorSlot
