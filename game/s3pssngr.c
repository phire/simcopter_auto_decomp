// Module: S3pssngr.obj
// Source: C:\Copter\Source\Game\S3pssngr.c
// autogenerated by simcopter_tool from PDB file

// Type: struct tagHeliPassengerData (forward reference);

// Type: int32_t;

// Type: void;

// Type: long;

// Type: struct tagPassengerInfo (forward reference);

// Type: int32_t[16];

// Type: int32_t *;



// Contribution: 1:000f8bc0-000f9082 Module: 174, 16 byte alignment, code, execute, read, 
// FUNCTION: COPTER_D 0x004f9bc0
int32_t HeliPassengerHasChanged(struct tagHeliPassengerData* heliPassengerData) {
// LINE 30:
	__asm        mov    eax, heliPassengerData;
	__asm        mov    eax, [eax];
	__asm        jmp    near ptr 0x004F9BD0;
// LINE 31:
}

// FUNCTION: COPTER_D 0x004f9bd5
void HeliPassengerSetChanged(struct tagHeliPassengerData* heliPassengerData) {
// LINE 38:
	__asm        mov    eax, heliPassengerData;
	__asm        mov    dword ptr [eax], 1;
// LINE 39:
}

// FUNCTION: COPTER_D 0x004f9be9
void HeliPassengerClearChanged(struct tagHeliPassengerData* heliPassengerData) {
// LINE 46:
	__asm        mov    eax, heliPassengerData;
	__asm        mov    dword ptr [eax], 0;
// LINE 47:
}

// FUNCTION: COPTER_D 0x004f9bfd
void HeliPassengerInit(struct tagHeliPassengerData* heliPassengerData, int32_t nHeliType) {
	long lSeatsTotal;
	long lRowWidth;
	int32_t i;

// LINE 59:
	__asm        mov    eax, heliPassengerData;
	__asm        mov    dword ptr [eax], 0;
// LINE 60:
	__asm        mov    eax, heliPassengerData;
	__asm        mov    dword ptr [eax+8], 0;
// LINE 61:
	__asm        mov    eax, heliPassengerData;
	__asm        mov    dword ptr [eax+0x10], 0;
// LINE 62:
	__asm        mov    eax, heliPassengerData;
	__asm        mov    dword ptr [eax+0x18], 0;
// LINE 63:
	__asm        mov    eax, nHeliType;
	__asm        mov    ecx, eax;
	__asm        lea    eax, [eax+eax*4];
	__asm        lea    eax, [ecx+eax*2];
	__asm        mov    eax, [eax*8+0x5B497C];
	__asm        mov    lSeatsTotal, eax;
	__asm        mov    eax, lSeatsTotal;
	__asm        mov    ecx, heliPassengerData;
	__asm        mov    [ecx+4], eax;
// LINE 64:
	__asm        mov    lRowWidth, 5;
	__asm        mov    eax, lRowWidth;
	__asm        mov    ecx, heliPassengerData;
	__asm        mov    [ecx+0x14], eax;
// LINE 73:
	__asm        mov    eax, lSeatsTotal;
	__asm        cdq;
	__asm        idiv   lRowWidth;
	__asm        mov    ecx, eax;
	__asm        mov    eax, lRowWidth;
	__asm        cdq;
	__asm        sub    eax, edx;
	__asm        sar    eax, 1;
	__asm        imul   ecx, eax;
	__asm        mov    eax, lSeatsTotal;
	__asm        cdq;
	__asm        idiv   lRowWidth;
	__asm        mov    eax, edx;
	__asm        cdq;
	__asm        sub    eax, edx;
	__asm        sar    eax, 1;
	__asm        add    ecx, eax;
	__asm        mov    eax, heliPassengerData;
	__asm        mov    [eax+0xC], ecx;
// LINE 76:
	__asm        mov    i, 0;
	__asm        jmp    near ptr 0x004F9C96;
	__asm        inc    i;
	__asm        cmp    i, 0x10;
	__asm        jge    near ptr 0x004F9CF5;
// LINE 77:
	__asm        mov    eax, i;
	__asm        shl    eax, 2;
	__asm        lea    eax, [eax+eax*4];
	__asm        mov    ecx, heliPassengerData;
	__asm        mov    dword ptr [eax+ecx+0x1C], 0xFFFFFFFF;
// LINE 78:
	__asm        mov    eax, i;
	__asm        shl    eax, 2;
	__asm        lea    eax, [eax+eax*4];
	__asm        mov    ecx, heliPassengerData;
	__asm        mov    dword ptr [eax+ecx+0x20], 0;
// LINE 79:
	__asm        mov    eax, i;
	__asm        shl    eax, 2;
	__asm        lea    eax, [eax+eax*4];
	__asm        mov    ecx, heliPassengerData;
	__asm        mov    dword ptr [eax+ecx+0x24], 0;
// LINE 80:
	__asm        mov    eax, i;
	__asm        shl    eax, 2;
	__asm        lea    eax, [eax+eax*4];
	__asm        mov    ecx, heliPassengerData;
	__asm        mov    dword ptr [eax+ecx+0x28], 0xFFFFFFFF;
// LINE 81:
	__asm        jmp    near ptr 0x004F9C93;
// LINE 82:
}

// FUNCTION: COPTER_D 0x004f9cfa
int32_t HeliPassengerCanAdd(struct tagHeliPassengerData* heliPassengerData, struct tagPassengerInfo* passenger) {
// LINE 95:
	__asm        mov    eax, heliPassengerData;
	__asm        mov    eax, [eax+4];
	__asm        mov    ecx, heliPassengerData;
	__asm        sub    eax, [ecx+8];
	__asm        jmp    near ptr 0x004F9D11;
// LINE 96:
}

// FUNCTION: COPTER_D 0x004f9d16
int32_t HeliPassengerAdd(struct tagHeliPassengerData* heliPassengerData, struct tagPassengerInfo* passenger) {
	int32_t i;

// LINE 111:
	__asm        mov    eax, passenger;
	__asm        push   eax;
	__asm        mov    eax, heliPassengerData;
	__asm        push   eax;
	__asm        call   HeliPassengerCanAdd;
	__asm        add    esp, 8;
	__asm        test   eax, eax;
	__asm        jne    near ptr 0x004F9D3E;
// LINE 112:
	__asm        xor    eax, eax;
	__asm        jmp    near ptr 0x004F9DFF;
// LINE 114:
	__asm        mov    i, 0;
	__asm        jmp    near ptr 0x004F9D4D;
	__asm        inc    i;
	__asm        cmp    i, 0x10;
	__asm        jge    near ptr 0x004F9DF8;
// LINE 116:
	__asm        mov    eax, i;
	__asm        shl    eax, 2;
	__asm        lea    eax, [eax+eax*4];
	__asm        mov    ecx, heliPassengerData;
	__asm        cmp    dword ptr [eax+ecx+0x1C], 0xFFFFFFFF;
	__asm        jne    near ptr 0x004F9DF3;
// LINE 117:
	__asm        mov    eax, passenger;
	__asm        mov    eax, [eax];
	__asm        mov    ecx, i;
	__asm        shl    ecx, 2;
	__asm        lea    ecx, [ecx+ecx*4];
	__asm        mov    edx, heliPassengerData;
	__asm        mov    [ecx+edx+0x1C], eax;
// LINE 118:
	__asm        mov    eax, passenger;
	__asm        mov    eax, [eax+4];
	__asm        mov    ecx, i;
	__asm        shl    ecx, 2;
	__asm        lea    ecx, [ecx+ecx*4];
	__asm        mov    edx, heliPassengerData;
	__asm        mov    [ecx+edx+0x20], eax;
// LINE 119:
	__asm        mov    eax, passenger;
	__asm        mov    eax, [eax+8];
	__asm        mov    ecx, i;
	__asm        shl    ecx, 2;
	__asm        lea    ecx, [ecx+ecx*4];
	__asm        mov    edx, heliPassengerData;
	__asm        mov    [ecx+edx+0x24], eax;
// LINE 120:
	__asm        mov    eax, passenger;
	__asm        mov    eax, [eax+0xC];
	__asm        mov    ecx, i;
	__asm        shl    ecx, 2;
	__asm        lea    ecx, [ecx+ecx*4];
	__asm        mov    edx, heliPassengerData;
	__asm        mov    [ecx+edx+0x28], eax;
// LINE 121:
	__asm        mov    eax, heliPassengerData;
	__asm        inc    dword ptr [eax+8];
// LINE 122:
	__asm        mov    eax, heliPassengerData;
	__asm        inc    dword ptr [eax+0x18];
// LINE 125:
	__asm        mov    eax, heliPassengerData;
	__asm        push   eax;
	__asm        call   HeliPassengerFitToSeats;
	__asm        add    esp, 4;
// LINE 126:
	__asm        mov    eax, heliPassengerData;
	__asm        push   eax;
	__asm        call   HeliPassengerSetChanged;
	__asm        add    esp, 4;
// LINE 130:
	__asm        mov    eax, 1;
	__asm        jmp    near ptr 0x004F9DFF;
// LINE 132:
	__asm        jmp    near ptr 0x004F9D4A;
// LINE 135:
	__asm        xor    eax, eax;
	__asm        jmp    near ptr 0x004F9DFF;
// LINE 136:
}

// FUNCTION: COPTER_D 0x004f9e04
int32_t HeliPassengerGetIndexInHeli(struct tagHeliPassengerData* heliPassengerData, long id) {
	int32_t i;

// LINE 147:
	__asm        mov    i, 0;
	__asm        jmp    near ptr 0x004F9E1C;
	__asm        inc    i;
	__asm        cmp    i, 0x10;
	__asm        jge    near ptr 0x004F9E4C;
// LINE 148:
	__asm        mov    eax, i;
	__asm        shl    eax, 2;
	__asm        lea    eax, [eax+eax*4];
	__asm        mov    ecx, heliPassengerData;
	__asm        mov    edx, id;
	__asm        cmp    [eax+ecx+0x28], edx;
	__asm        jne    near ptr 0x004F9E47;
// LINE 149:
	__asm        mov    eax, i;
	__asm        jmp    near ptr 0x004F9E56;
// LINE 151:
	__asm        jmp    near ptr 0x004F9E19;
// LINE 152:
	__asm        mov    eax, 0xFFFFFFFF;
	__asm        jmp    near ptr 0x004F9E56;
// LINE 153:
}

// FUNCTION: COPTER_D 0x004f9e5b
int32_t HeliPassengerSetExpression(struct tagHeliPassengerData* heliPassengerData, long id, int32_t expression) {
	int32_t i;

// LINE 160:
	__asm        mov    eax, id;
	__asm        push   eax;
	__asm        mov    eax, heliPassengerData;
	__asm        push   eax;
	__asm        call   HeliPassengerGetIndexInHeli;
	__asm        add    esp, 8;
	__asm        mov    i, eax;
// LINE 162:
	__asm        cmp    i, 0xFFFFFFFF;
	__asm        je     near ptr 0x004F9E9E;
// LINE 163:
	__asm        mov    eax, expression;
	__asm        mov    ecx, i;
	__asm        shl    ecx, 2;
	__asm        lea    ecx, [ecx+ecx*4];
	__asm        mov    edx, heliPassengerData;
	__asm        mov    [ecx+edx+0x20], eax;
// LINE 164:
	__asm        mov    eax, 1;
	__asm        jmp    near ptr 0x004F9EA5;
// LINE 166:
	__asm        xor    eax, eax;
	__asm        jmp    near ptr 0x004F9EA5;
// LINE 167:
}

// FUNCTION: COPTER_D 0x004f9eaa
int32_t HeliPassengerRemove(struct tagHeliPassengerData* heliPassengerData, long id) {
	int32_t i;

// LINE 174:
	__asm        mov    eax, id;
	__asm        push   eax;
	__asm        mov    eax, heliPassengerData;
	__asm        push   eax;
	__asm        call   HeliPassengerGetIndexInHeli;
	__asm        add    esp, 8;
	__asm        mov    i, eax;
// LINE 176:
	__asm        cmp    i, 0xFFFFFFFF;
	__asm        je     near ptr 0x004F9F62;
// LINE 177:
	__asm        mov    eax, heliPassengerData;
	__asm        dec    dword ptr [eax+8];
// LINE 178:
	__asm        mov    eax, i;
	__asm        shl    eax, 2;
	__asm        lea    eax, [eax+eax*4];
	__asm        mov    ecx, heliPassengerData;
	__asm        mov    dword ptr [eax+ecx+0x1C], 0xFFFFFFFF;
// LINE 179:
	__asm        mov    eax, i;
	__asm        shl    eax, 2;
	__asm        lea    eax, [eax+eax*4];
	__asm        mov    ecx, heliPassengerData;
	__asm        mov    dword ptr [eax+ecx+0x20], 0;
// LINE 180:
	__asm        mov    eax, i;
	__asm        shl    eax, 2;
	__asm        lea    eax, [eax+eax*4];
	__asm        mov    ecx, heliPassengerData;
	__asm        mov    dword ptr [eax+ecx+0x24], 0;
// LINE 181:
	__asm        mov    eax, i;
	__asm        shl    eax, 2;
	__asm        lea    eax, [eax+eax*4];
	__asm        mov    ecx, heliPassengerData;
	__asm        mov    dword ptr [eax+ecx+0x28], 0;
// LINE 182:
	__asm        mov    eax, i;
	__asm        shl    eax, 2;
	__asm        lea    eax, [eax+eax*4];
	__asm        mov    ecx, heliPassengerData;
	__asm        mov    dword ptr [eax+ecx+0x2C], 0;
// LINE 183:
	__asm        mov    eax, heliPassengerData;
	__asm        dec    dword ptr [eax+0x18];
// LINE 186:
	__asm        mov    eax, heliPassengerData;
	__asm        push   eax;
	__asm        call   HeliPassengerFitToSeats;
	__asm        add    esp, 4;
// LINE 187:
	__asm        mov    eax, heliPassengerData;
	__asm        push   eax;
	__asm        call   HeliPassengerSetChanged;
	__asm        add    esp, 4;
// LINE 188:
	__asm        mov    eax, 1;
	__asm        jmp    near ptr 0x004F9F69;
// LINE 192:
	__asm        xor    eax, eax;
	__asm        jmp    near ptr 0x004F9F69;
// LINE 193:
}

// FUNCTION: COPTER_D 0x004f9f6e
long HeliPassengerCountFreeSeats(struct tagHeliPassengerData* heliPassengerData) {
// LINE 204:
	__asm        mov    eax, heliPassengerData;
	__asm        mov    eax, [eax+4];
	__asm        mov    ecx, heliPassengerData;
	__asm        sub    eax, [ecx+8];
	__asm        jmp    near ptr 0x004F9F85;
// LINE 205:
}

// FUNCTION: COPTER_D 0x004f9f8a
void HeliPassengerFitToSeats(struct tagHeliPassengerData* heliPassengerData) {
	int32_t i;
	int32_t nSeat;
	int32_t bSeats[16];

// LINE 220:
	__asm        mov    i, 0;
	__asm        jmp    near ptr 0x004F9FA2;
	__asm        inc    i;
	__asm        cmp    i, 0x10;
	__asm        jge    near ptr 0x004F9FBC;
// LINE 221:
	__asm        mov    eax, i;
	__asm        mov    dword ptr [ebp+eax*4-0x40], 0;
	__asm        jmp    near ptr 0x004F9F9F;
// LINE 223:
	__asm        mov    i, 0;
	__asm        jmp    near ptr 0x004F9FCB;
	__asm        inc    i;
	__asm        cmp    i, 0x10;
	__asm        jge    near ptr 0x004FA02E;
// LINE 224:
	__asm        mov    eax, i;
	__asm        shl    eax, 2;
	__asm        lea    eax, [eax+eax*4];
	__asm        mov    ecx, heliPassengerData;
	__asm        cmp    dword ptr [eax+ecx+0x1C], 0xFFFFFFFF;
	__asm        je     near ptr 0x004FA029;
// LINE 225:
	__asm        lea    eax, bSeats[0];
	__asm        push   eax;
	__asm        mov    eax, heliPassengerData;
	__asm        mov    eax, [eax+0x14];
	__asm        push   eax;
	__asm        mov    eax, heliPassengerData;
	__asm        mov    eax, [eax+4];
	__asm        push   eax;
	__asm        push   1;
	__asm        call   FindFreeSeatForPassenger;
	__asm        add    esp, 0x10;
	__asm        mov    nSeat, eax;
// LINE 226:
	__asm        mov    eax, nSeat;
	__asm        mov    dword ptr [ebp+eax*4-0x40], 1;
// LINE 227:
	__asm        mov    eax, nSeat;
	__asm        mov    ecx, i;
	__asm        shl    ecx, 2;
	__asm        lea    ecx, [ecx+ecx*4];
	__asm        mov    edx, heliPassengerData;
	__asm        mov    [ecx+edx+0x2C], eax;
// LINE 229:
	__asm        jmp    near ptr 0x004F9FC8;
// LINE 230:
}

// FUNCTION: COPTER_D 0x004fa033
int32_t FindFreeSeatForPassenger(int32_t nPassengerSeatUsage, int32_t nSeatsTotal, int32_t nRowWidth, int32_t * bSeats) {
	int32_t j;

// LINE 245:
	__asm        mov    j, 0;
	__asm        jmp    near ptr 0x004FA04B;
	__asm        inc    j;
	__asm        mov    eax, nSeatsTotal;
	__asm        cmp    j, eax;
	__asm        jge    near ptr 0x004FA074;
// LINE 246:
	__asm        mov    eax, j;
	__asm        mov    ecx, bSeats;
	__asm        cmp    dword ptr [ecx+eax*4], 0;
	__asm        jne    near ptr 0x004FA06F;
// LINE 247:
	__asm        mov    eax, j;
	__asm        jmp    near ptr 0x004FA07E;
// LINE 248:
	__asm        jmp    near ptr 0x004FA048;
// LINE 249:
	__asm        mov    eax, 0xFFFFFFFF;
	__asm        jmp    near ptr 0x004FA07E;
// LINE 250:
}

