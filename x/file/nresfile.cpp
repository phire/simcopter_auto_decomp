// Module: Nresfile.obj
// Source: C:\Copter\Source\X\File\Nresfile.cpp
// autogenerated by simcopter_tool from PDB file

// Type: class NResFile (forward reference);
class NResFile : public FlatFile, public FlatResFile, public ResFile
{
protected:
	class FlatFile* fNext;
	unsigned char[256] fName;
	long fFileID;
	struct _iobuf* fFile;
	long UniqueID();
private:
	static class FlatFile* sList;
	static long sLastFileID;
	void Link();
	void Unlink();
	unsigned short Exclusive();
public:
	void FlatFile();
	// vtable: 0
	intro void ~FlatFile();
	// calltype: NearC
	static class FlatFile* FindByName(unsigned char *);
	unsigned short SameFile(class FlatFile*);
	// vtable: 4
	intro long NResFile(unsigned char *);
	// vtable: 8
	intro long NResFile(char *);
	// vtable: 12
	intro long Close();
	void OpenFromOtherFile(class FlatFile*);
	long GetFileName(unsigned char *);
	unsigned short ValidFile();
	long ReadBlock(void * __ptr32, long *);
	long Read4(long *);
	long Read2(short *);
	long Read1(char *);
	long SetPos(long);
	long Advance(long);
	// calltype: NearC
	static short CheckForLeaks();
	long GetFileID();
	struct _iobuf* GetFile();
protected:
	class ResMap* fMap;
	long fError;
	short _alignPad;
public:
	void FlatResFile();
	virtual void ~FlatResFile();
	void LoadResMap(void * __ptr32*, short *, long *);
	unsigned short FileEquals(class FlatResFile*);
	virtual long NResFile(unsigned char *);
	virtual long NResFile(char *);
	long OpenFromName();
	virtual long Close();
	short CountTypes();
	unsigned long GetIndType(short);
	short Count(unsigned long);
	void * __ptr32 GetByID(unsigned long, short, void (*)(void * __ptr32, long));
	void * __ptr32 GetByName(unsigned long, unsigned char *, void (*)(void * __ptr32, long));
	void * __ptr32 GetByIndex(unsigned long, short, void (*)(void * __ptr32, long));
	void GetName(void * __ptr32, unsigned char *);
	void GetID(void * __ptr32, short *);
	unsigned long GetResType(void * __ptr32);
	void Release(void * __ptr32);
	void Detach(void * __ptr32);
	void Load(void * __ptr32);
	long GetError();
	void Add(void * __ptr32, unsigned long, short, unsigned char *);
	void ExclusiveAdd(void * __ptr32, unsigned long, short, unsigned char *);
	void FindUniqueName(unsigned long, unsigned char *);
	short FindUniqueID(unsigned long);
	void Write(void * __ptr32);
	void Remove(void * __ptr32);
	void GetString(unsigned char *, short, short);
	// calltype: NearC
	static short CheckForLeaks();
	long OpenFromOtherFile(class ResFile*);
private:
	class PtrList<StdResLoader> fLoaders;
public:
	virtual void ~NResFile();
	class StdResLoader* GetLoader(unsigned long, void (*)(void * __ptr32, long));
	void ReleaseLoader(class StdResLoader*);
};

// Type: unsigned long;
// Type: void (void * __ptr32, long, );
// Type: class StdResLoader (forward reference);
class StdResLoader : public ResLoader<unsigned char,StdResInfo>
{
private:
	long fCount;
	struct StdResInfo* fResInfo;
	class ResFile* fFile;
	unsigned long fType;
public:
	unsigned long Type();
	void ResLoader<unsigned char,StdResInfo>(class ResFile*, unsigned long, void (*)(void * __ptr32, long));
	void ~ResLoader<unsigned char,StdResInfo>();
	struct StdResInfo* GetInfo(long);
	unsigned char * GetData(long);
	long Count();
	struct StdResInfo* GetInfoByIndex(long);
	unsigned char * GetDataByIndex(long);
	void StdResLoader(class ResFile*, unsigned long, void (*)(void * __ptr32, long));
};

// Type: class PtrList<StdResLoader>::Iter;
class PtrList<StdResLoader>::Iter{
private:
	class PtrList<StdResLoader>* fObject;
	struct PtrList<StdResLoader>::PtrNode* fCur;
public:
	void Iter(class PtrList<StdResLoader>*);
	class StdResLoader* Current();
	void Next();
	void Reset();
	class StdResLoader* First();
};

// Type: void;
// Type: uint32_t;


// Contribution: 1:00098ef0-0009943b Module: 16, 16 byte alignment, code, execute, read, 
// FUNCTION: COPTER_D 0x00499ef0
class StdResLoader* NResFile::GetLoader(unsigned long type, void (*)(void * __ptr32, long) swizzler) {
	class StdResLoader* loader;

// LINE 11:
	__asm        push   ebp;
	__asm        mov    ebp, esp;
	__asm        sub    esp, 0x38;
	__asm        push   ebx;
	__asm        push   esi;
	__asm        push   edi;
	__asm        mov    this, ecx;
// LINE 13:
// Block start:
	class PtrList<StdResLoader>::Iter i;
	__asm        mov    eax, this;
	__asm        add    eax, 0x11A;
	__asm        mov    i.fObject, eax;
	__asm        cmp    i.fObject, 0;
	__asm        je     near ptr 0x00499F1E;
	__asm        mov    eax, i.fObject;
	__asm        mov    eax, [eax];
	__asm        mov    i.fCur, eax;
	__asm        jmp    near ptr 0x00499F25;
	__asm        mov    i.fCur, 0;
	__asm        jmp    near ptr 0x00499F2A;
	__asm        jmp    near ptr 0x00499F2F;
// LINE 14:
	__asm        jmp    near ptr 0x00499F4C;
	__asm        cmp    i.fCur, 0;
	__asm        je     near ptr 0x00499F47;
	__asm        mov    eax, i.fCur;
	__asm        mov    eax, [eax+4];
	__asm        mov    i.fCur, eax;
	__asm        jmp    near ptr 0x00499F4C;
	__asm        cmp    i.fCur, 0;
	__asm        je     near ptr 0x00499F6C;
	__asm        mov    eax, i.fCur;
	__asm        cmp    dword ptr [eax], 0;
	__asm        je     near ptr 0x00499FE9;
	__asm        jmp    near ptr 0x00499F80;
	__asm        jmp    near ptr 0x00499F76;
	__asm        jmp    near ptr 0x00499FE9;
	__asm        jmp    near ptr 0x00499F80;
	__asm        cmp    dword ptr [ebp-0x18], 0;
	__asm        je     near ptr 0x00499FE9;
// LINE 15:
	__asm        cmp    i.fCur, 0;
	__asm        je     near ptr 0x00499F9C;
	__asm        mov    eax, i.fCur;
	__asm        mov    eax, [eax];
	__asm        mov    [ebp-0x14], eax;
	__asm        jmp    near ptr 0x00499FA8;
	__asm        jmp    near ptr 0x00499FA8;
	__asm        mov    dword ptr [ebp-0x14], 0;
	__asm        jmp    near ptr 0x00499FA8;
	__asm        jmp    near ptr 0x00499FAD;
	__asm        mov    eax, [ebp-0x14];
	__asm        mov    ecx, type;
	__asm        cmp    [eax+0xC], ecx;
	__asm        jne    near ptr 0x00499FE4;
// LINE 16:
	__asm        cmp    i.fCur, 0;
	__asm        je     near ptr 0x00499FD5;
	__asm        mov    eax, i.fCur;
	__asm        mov    eax, [eax];
	__asm        jmp    near ptr 0x00499FDF;
	__asm        jmp    near ptr 0x00499FDC;
	__asm        xor    eax, eax;
	__asm        jmp    near ptr 0x00499FDF;
	__asm        mov    eax, [ebp-0x1C];
	__asm        jmp    near ptr 0x0049A1EE;
// LINE 17:
	__asm        jmp    near ptr 0x00499F34;
// LINE 20:
// Block end:
	__asm        push   0x10;
	__asm        call   0x0056A600;
	__asm        add    esp, 4;
	__asm        mov    [ebp-0x10], eax;
	__asm        cmp    dword ptr [ebp-0x10], 0;
	__asm        je     near ptr 0x0049A13E;
	__asm        mov    eax, this;
	__asm        mov    ecx, [ebp-0x10];
	__asm        mov    [ecx+8], eax;
	__asm        mov    eax, type;
	__asm        mov    ecx, [ebp-0x10];
	__asm        mov    [ecx+0xC], eax;
	__asm        mov    eax, [ebp-0x10];
	__asm        cmp    dword ptr [eax+8], 0;
	__asm        je     near ptr 0x0049A03B;
	__asm        mov    eax, type;
	__asm        push   eax;
	__asm        mov    eax, [ebp-0x10];
	__asm        mov    ecx, [eax+8];
	__asm        call   0x0055319A;
	__asm        movsx  eax, ax;
	__asm        mov    ecx, [ebp-0x10];
	__asm        mov    [ecx], eax;
	__asm        jmp    near ptr 0x0049A044;
	__asm        mov    eax, [ebp-0x10];
	__asm        mov    dword ptr [eax], 0;
	__asm        mov    eax, [ebp-0x10];
	__asm        mov    eax, [eax];
	__asm        lea    eax, [eax+eax*2];
	__asm        shl    eax, 2;
	__asm        push   eax;
	__asm        call   0x0056A600;
	__asm        add    esp, 4;
	__asm        mov    ecx, [ebp-0x10];
	__asm        mov    [ecx+4], eax;
	__asm        mov    eax, [ebp-0x10];
	__asm        mov    eax, [eax];
	__asm        dec    eax;
	__asm        mov    [ebp-0x20], eax;
	__asm        jmp    near ptr 0x0049A06F;
	__asm        dec    dword ptr [ebp-0x20];
	__asm        cmp    dword ptr [ebp-0x20], 0;
	__asm        jl     near ptr 0x0049A129;
	__asm        mov    eax, swizzler;
	__asm        push   eax;
	__asm        mov    eax, [ebp-0x20];
	__asm        inc    eax;
	__asm        push   eax;
	__asm        mov    eax, type;
	__asm        push   eax;
	__asm        mov    eax, [ebp-0x10];
	__asm        mov    ecx, [eax+8];
	__asm        call   0x00553452;
	__asm        mov    [ebp-0x24], eax;
	__asm        mov    eax, [ebp-0x24];
	__asm        mov    ecx, [ebp-0x10];
	__asm        mov    ecx, [ecx+4];
	__asm        mov    edx, [ebp-0x20];
	__asm        lea    edx, [edx+edx*2];
	__asm        mov    [ecx+edx*4+4], eax;
	__asm        cmp    dword ptr [ebp-0x24], 0;
	__asm        je     near ptr 0x0049A0FD;
	__asm        mov    eax, [ebp-0x24];
	__asm        push   eax;
	__asm        call   0x00554B04;
	__asm        add    esp, 4;
	__asm        mov    ecx, [ebp-0x10];
	__asm        mov    ecx, [ecx+4];
	__asm        mov    edx, [ebp-0x20];
	__asm        lea    edx, [edx+edx*2];
	__asm        mov    [ecx+edx*4+8], eax;
	__asm        lea    eax, [ebp-0x28];
	__asm        push   eax;
	__asm        mov    eax, [ebp-0x24];
	__asm        push   eax;
	__asm        mov    eax, [ebp-0x10];
	__asm        mov    ecx, [eax+8];
	__asm        call   0x0055360D;
	__asm        movsx  eax, word ptr [ebp-0x28];
	__asm        mov    ecx, [ebp-0x10];
	__asm        mov    ecx, [ecx+4];
	__asm        mov    edx, [ebp-0x20];
	__asm        lea    edx, [edx+edx*2];
	__asm        mov    [ecx+edx*4], eax;
	__asm        jmp    near ptr 0x0049A0F8;
	__asm        jmp    near ptr 0x0049A124;
	__asm        mov    eax, [ebp-0x10];
	__asm        mov    eax, [eax+4];
	__asm        mov    ecx, [ebp-0x20];
	__asm        lea    ecx, [ecx+ecx*2];
	__asm        mov    dword ptr [eax+ecx*4+8], 0;
	__asm        mov    eax, [ebp-0x10];
	__asm        mov    eax, [eax+4];
	__asm        mov    ecx, [ebp-0x20];
	__asm        lea    ecx, [ecx+ecx*2];
	__asm        mov    dword ptr [eax+ecx*4], 0;
	__asm        jmp    near ptr 0x0049A06C;
	__asm        jmp    near ptr 0x0049A12E;
	__asm        jmp    near ptr 0x0049A133;
	__asm        mov    eax, [ebp-0x10];
	__asm        mov    loader, eax;
	__asm        jmp    near ptr 0x0049A145;
	__asm        mov    loader, 0;
// LINE 21:
	__asm        cmp    loader, 0;
	__asm        je     near ptr 0x0049A1A2;
	__asm        mov    eax, this;
	__asm        mov    eax, [eax+0x11A];
	__asm        mov    [ebp-0x30], eax;
	__asm        jmp    near ptr 0x0049A169;
	__asm        mov    eax, [ebp-0x30];
	__asm        mov    eax, [eax+4];
	__asm        mov    [ebp-0x30], eax;
	__asm        cmp    dword ptr [ebp-0x30], 0;
	__asm        je     near ptr 0x0049A18B;
	__asm        mov    eax, [ebp-0x30];
	__asm        mov    ecx, loader;
	__asm        cmp    [eax], ecx;
	__asm        jne    near ptr 0x0049A186;
	__asm        jmp    near ptr 0x0049A1A2;
	__asm        jmp    near ptr 0x0049A160;
	__asm        jmp    near ptr 0x0049A1A7;
	__asm        jmp    near ptr 0x0049A1A2;
	__asm        test   dword ptr [ebp-0x34], 0xFFFF;
	__asm        je     near ptr 0x0049A1A7;
	__asm        jmp    near ptr 0x0049A1E6;
	__asm        push   8;
	__asm        call   0x0056A600;
	__asm        add    esp, 4;
	__asm        mov    [ebp-0x2C], eax;
	__asm        mov    eax, loader;
	__asm        mov    ecx, [ebp-0x2C];
	__asm        mov    [ecx], eax;
	__asm        mov    eax, this;
	__asm        mov    eax, [eax+0x11A];
	__asm        mov    ecx, [ebp-0x2C];
	__asm        mov    [ecx+4], eax;
	__asm        mov    eax, [ebp-0x2C];
	__asm        mov    ecx, this;
	__asm        mov    [ecx+0x11A], eax;
	__asm        mov    eax, this;
	__asm        inc    word ptr [eax+0x11E];
	__asm        jmp    near ptr 0x0049A1E6;
// LINE 22:
	__asm        mov    eax, loader;
	__asm        jmp    near ptr 0x0049A1EE;
// LINE 23:
	__asm        pop    edi;
	__asm        pop    esi;
	__asm        pop    ebx;
	__asm        leave;
	__asm        ret    8;
}

// FUNCTION: COPTER_D 0x0049a1f5
void NResFile::~NResFile() {
	class PtrList<StdResLoader>::Iter i;

// LINE 30:
	__asm        push   ebp;
	__asm        mov    ebp, esp;
	__asm        sub    esp, 0x30;
	__asm        push   ebx;
	__asm        push   esi;
	__asm        push   edi;
	__asm        mov    this, ecx;
	__asm        mov    eax, this;
	__asm        mov    dword ptr [eax], 0x591218;
// LINE 31:
	__asm        mov    eax, this;
	__asm        add    eax, 0x11A;
	__asm        mov    i.fObject, eax;
	__asm        cmp    i.fObject, 0;
	__asm        je     near ptr 0x0049A22C;
	__asm        mov    eax, i.fObject;
	__asm        mov    eax, [eax];
	__asm        mov    i.fCur, eax;
	__asm        jmp    near ptr 0x0049A233;
	__asm        mov    i.fCur, 0;
	__asm        jmp    near ptr 0x0049A238;
	__asm        jmp    near ptr 0x0049A23D;
// LINE 32:
	__asm        jmp    near ptr 0x0049A25A;
	__asm        cmp    i.fCur, 0;
	__asm        je     near ptr 0x0049A255;
	__asm        mov    eax, i.fCur;
	__asm        mov    eax, [eax+4];
	__asm        mov    i.fCur, eax;
	__asm        jmp    near ptr 0x0049A25A;
	__asm        cmp    i.fCur, 0;
	__asm        je     near ptr 0x0049A27A;
	__asm        mov    eax, i.fCur;
	__asm        cmp    dword ptr [eax], 0;
	__asm        je     near ptr 0x0049A342;
	__asm        jmp    near ptr 0x0049A28E;
	__asm        jmp    near ptr 0x0049A284;
	__asm        jmp    near ptr 0x0049A342;
	__asm        jmp    near ptr 0x0049A28E;
	__asm        cmp    dword ptr [ebp-0x14], 0;
	__asm        je     near ptr 0x0049A342;
// LINE 33:
	__asm        cmp    i.fCur, 0;
	__asm        je     near ptr 0x0049A2AA;
	__asm        mov    eax, i.fCur;
	__asm        mov    eax, [eax];
	__asm        mov    [ebp-0x10], eax;
	__asm        jmp    near ptr 0x0049A2B6;
	__asm        jmp    near ptr 0x0049A2B6;
	__asm        mov    dword ptr [ebp-0x10], 0;
	__asm        jmp    near ptr 0x0049A2B6;
	__asm        mov    eax, [ebp-0x10];
	__asm        mov    [ebp-0xC], eax;
	__asm        cmp    dword ptr [ebp-0xC], 0;
	__asm        je     near ptr 0x0049A33D;
	__asm        jmp    near ptr 0x0049A2CB;
	__asm        mov    eax, [ebp-0xC];
	__asm        mov    eax, [eax];
	__asm        dec    eax;
	__asm        mov    [ebp-0x18], eax;
	__asm        jmp    near ptr 0x0049A2DC;
	__asm        dec    dword ptr [ebp-0x18];
	__asm        cmp    dword ptr [ebp-0x18], 0;
	__asm        jl     near ptr 0x0049A307;
	__asm        mov    eax, [ebp-0xC];
	__asm        mov    eax, [eax+4];
	__asm        mov    ecx, [ebp-0x18];
	__asm        lea    ecx, [ecx+ecx*2];
	__asm        mov    eax, [eax+ecx*4+4];
	__asm        push   eax;
	__asm        mov    eax, [ebp-0xC];
	__asm        mov    ecx, [eax+8];
	__asm        call   0x00553794;
	__asm        jmp    near ptr 0x0049A2D9;
	__asm        mov    eax, [ebp-0xC];
	__asm        mov    eax, [eax+4];
	__asm        mov    [ebp-0x1C], eax;
	__asm        mov    eax, [ebp-0x1C];
	__asm        mov    [ebp-0x20], eax;
	__asm        mov    eax, [ebp-0x20];
	__asm        push   eax;
	__asm        call   0x0056A740;
	__asm        add    esp, 4;
	__asm        jmp    near ptr 0x0049A327;
	__asm        mov    eax, [ebp-0xC];
	__asm        push   eax;
	__asm        call   0x0056A740;
	__asm        add    esp, 4;
	__asm        jmp    near ptr 0x0049A338;
	__asm        jmp    near ptr 0x0049A33D;
// LINE 34:
	__asm        jmp    near ptr 0x0049A242;
// LINE 35:
	__asm        jmp    near ptr 0x0049A347;
	__asm        mov    eax, this;
	__asm        cmp    dword ptr [eax+0x11A], 0;
	__asm        je     near ptr 0x0049A3CA;
	__asm        mov    eax, this;
	__asm        mov    eax, [eax+0x11A];
	__asm        mov    [ebp-0x24], eax;
	__asm        mov    eax, this;
	__asm        mov    eax, [eax+0x11A];
	__asm        mov    eax, [eax+4];
	__asm        mov    ecx, this;
	__asm        mov    [ecx+0x11A], eax;
	__asm        mov    eax, [ebp-0x24];
	__asm        mov    [ebp-0x28], eax;
	__asm        mov    eax, [ebp-0x28];
	__asm        mov    [ebp-0x2C], eax;
	__asm        mov    eax, [ebp-0x2C];
	__asm        push   eax;
	__asm        call   0x0056A740;
	__asm        add    esp, 4;
	__asm        mov    eax, this;
	__asm        dec    word ptr [eax+0x11E];
	__asm        mov    eax, this;
	__asm        movsx  eax, word ptr [eax+0x11E];
	__asm        test   eax, eax;
	__asm        jge    near ptr 0x0049A3C5;
	__asm        push   0x8C085;
	__asm        push   0x59A24C;
	__asm        push   0x26;
	__asm        push   0x59A254;
	__asm        call   0x00554F30;
	__asm        add    esp, 0x10;
	__asm        jmp    near ptr 0x0049A347;
	__asm        mov    eax, this;
	__asm        movsx  eax, word ptr [eax+0x11E];
	__asm        test   eax, eax;
	__asm        je     near ptr 0x0049A3F5;
	__asm        push   0x8C085;
	__asm        push   0x59A24C;
	__asm        push   0x28;
	__asm        push   0x59A254;
	__asm        call   0x00554F30;
	__asm        add    esp, 0x10;
	__asm        jmp    near ptr 0x0049A3FA;
	__asm        mov    eax, this;
	__asm        movsx  eax, word ptr [eax+0x11E];
	__asm        test   eax, eax;
	__asm        je     near ptr 0x0049A425;
	__asm        push   0x8C085;
	__asm        push   0x59A274;
	__asm        push   0x17;
	__asm        push   0x59A254;
	__asm        call   0x00554F30;
	__asm        add    esp, 0x10;
	__asm        jmp    near ptr 0x0049A42A;
	__asm        jmp    near ptr 0x0049A42F;
	__asm        mov    ecx, this;
	__asm        call   0x0055301B;
	__asm        pop    edi;
	__asm        pop    esi;
	__asm        pop    ebx;
	__asm        leave;
	__asm        ret;
}



// Contribution: 1:00099440-00099478 Module: 16, 16 byte alignment, code, (comdat), execute, read, 
// FUNCTION: COPTER_D 0x0049a440
// NResFile::`scalar deleting destructor'



// Contribution: 2:00002218-00002227 Module: 16, 8 byte alignment, initialized_data, (comdat), read, 
// GLOBAL: COPTER_D 0x00591218
// ??_7NResFile@@6B@


// Contribution: 3:0000324c-00003252 Module: 16, 4 byte alignment, initialized_data, (comdat), read, write, 
// GLOBAL: COPTER_D 0x0059a24c
// ??_C@_06BBEO@whoops?$AA@


// Contribution: 3:00003254-00003270 Module: 16, 4 byte alignment, initialized_data, (comdat), read, write, 
// GLOBAL: COPTER_D 0x0059a254
// ??_C@_0BN@BGMO@c?3?2copter?2source?2x?2PtrList?4h?$AA@


// Contribution: 3:00003274-0000328a Module: 16, 4 byte alignment, initialized_data, (comdat), read, write, 
// GLOBAL: COPTER_D 0x0059a274
// ??_C@_0BH@OELJ@count?5error?5in?5ptrlist?$AA@
