// Module: Srand.obj
// Source: C:\Copter\Source\X\Srand.cpp
// autogenerated by simcopter_tool from PDB file

// Type: /*unpacked*/ union __unnamed;

// Type: unsigned long;

// Type: void;

// Type: unsigned short;

// Type: short;



// Contribution: 1:0015c500-0015c948 Module: 193, 16 byte alignment, code, execute, read, 
// FUNCTION: COPTER_D 0x0055d500
void SetRRandSeed(unsigned long n) {

	rrandSeed<__unnamed+0x00:4> = n;
	__asm        jmp    __RETURN;
__RETURN:
}

// FUNCTION: COPTER_D 0x0055d518
unsigned long GetSRandSeed() {

	__asm        mov    eax, srandSeed;
	__asm        jmp    __RETURN;
__RETURN:
}

// FUNCTION: COPTER_D 0x0055d52d
void SetSRandSeed(unsigned long theSeed) {

	srandSeed = theSeed;
	__asm        jmp    __RETURN;
__RETURN:
}

// FUNCTION: COPTER_D 0x0055d545
unsigned short RRand(unsigned short lim) {
	/*bp-0x4*/   unsigned long myRandom0;
	/*bp-0x8*/   unsigned long myRandom5;
	/*bp-0xc*/   unsigned long myRandom1;
	/*bp-0x10*/  unsigned long myRandom2;
	/*bp-0x14*/  unsigned long myRandom3;
	/*bp-0x18*/  unsigned long myRandom4;

// LINE 59:
	myRandom0 = 0x41c64e6d;
// LINE 60:
	myRandom1 = rrandSeed<__unnamed+0x00:4>;
// LINE 61:
	myRandom2 = myRandom0;
// LINE 62:
	myRandom3 = myRandom1;
// LINE 66:
	__asm        mov    eax, myRandom2;
	__asm        and    eax, 0xFFFF;
	__asm        shl    eax, 0x10;
	__asm        movzx  eax, ax;
	__asm        mov    ecx, myRandom2;
	__asm        and    ecx, 0xFFFF;
	__asm        shr    ecx, 0x10;
	__asm        movzx  ecx, cx;
	__asm        or     eax, ecx;
	__asm        mov    myRandom2, eax;
// LINE 68:
	__asm        mov    eax, myRandom3;
	__asm        and    eax, 0xFFFF;
	__asm        movzx  eax, ax;
	__asm        mov    ecx, myRandom2;
	__asm        and    ecx, 0xFFFF;
	__asm        movzx  ecx, cx;
	__asm        imul   eax, ecx;
	__asm        mov    myRandom2, eax;
// LINE 70:
	myRandom4 = myRandom0;
// LINE 71:
	myRandom5 = myRandom1;
// LINE 73:
	__asm        mov    eax, myRandom5;
	__asm        and    eax, 0xFFFF;
	__asm        shl    eax, 0x10;
	__asm        movzx  eax, ax;
	__asm        mov    ecx, myRandom5;
	__asm        and    ecx, 0xFFFF;
	__asm        shr    ecx, 0x10;
	__asm        movzx  ecx, cx;
	__asm        or     eax, ecx;
	__asm        mov    myRandom5, eax;
// LINE 75:
	__asm        mov    eax, myRandom5;
	__asm        and    eax, 0xFFFF;
	__asm        movzx  eax, ax;
	__asm        mov    ecx, myRandom4;
	__asm        and    ecx, 0xFFFF;
	__asm        movzx  ecx, cx;
	__asm        imul   eax, ecx;
	__asm        mov    myRandom4, eax;
// LINE 77:
	myRandom2 = (((myRandom4 & 0xffff) + (myRandom2 & 0xffff)) & 0xffff);
// LINE 79:
	__asm        mov    eax, myRandom2;
	__asm        and    eax, 0xFFFF;
	__asm        shl    eax, 0x10;
	__asm        movzx  eax, ax;
	__asm        mov    ecx, myRandom2;
	__asm        and    ecx, 0xFFFF;
	__asm        shr    ecx, 0x10;
	__asm        movzx  ecx, cx;
	__asm        or     eax, ecx;
	__asm        mov    myRandom2, eax;
// LINE 81:
	__asm        and    myRandom2, 0xFFFF0000;
// LINE 83:
	__asm        mov    eax, myRandom1;
	__asm        and    eax, 0xFFFF;
	__asm        movzx  eax, ax;
	__asm        mov    ecx, myRandom0;
	__asm        and    ecx, 0xFFFF;
	__asm        movzx  ecx, cx;
	__asm        imul   eax, ecx;
	__asm        mov    myRandom0, eax;
// LINE 85:
	myRandom0 += myRandom2;
// LINE 87:
	myRandom0 += 0x3039;
// LINE 89:
	rrandSeed<__unnamed+0x00:4> = myRandom0;
// LINE 91:
	myRandom0 = 0x0;
// LINE 92:
	myRandom0 = (rrandSeed<__unnamed+0x00:4> >> 0x10);
// LINE 94:
	__asm        and    myRandom0, 0x7FFF;
// LINE 96:
	__asm        mov    eax, myRandom0;
	__asm        and    eax, 0xFFFF;
	__asm        mov    ecx, reinterpret_cast<uint32_t>(lim);
	__asm        and    ecx, 0xFFFF;
	__asm        cdq;
	__asm        idiv   ecx;
	__asm        mov    ax, dx;
	__asm        jmp    __RETURN;
// LINE 97:
__RETURN:
}

// FUNCTION: COPTER_D 0x0055d6a3
unsigned short GetNextRandomNumber() {
	/*bp-0x4*/   unsigned short temp;

// LINE 107:
	__asm        mov    eax, srandSeed;
	__asm        mov    temp, ax;
// LINE 109:
	__asm        test   *reinterpret_cast<uint8_t*>(reinterpret_cast<char*>(&temp) + 1), 0x80;
	__asm        je     _T34;
// LINE 110:
	__asm        mov    eax, reinterpret_cast<uint32_t>(temp);
	__asm        and    eax, 0xFFFF;
	__asm        add    eax, eax;
	__asm        xor    eax, 0x1BF5;
	__asm        mov    temp, ax;
// LINE 111:
	__asm        jmp    _T39;
_T34:
	__asm        shl    temp, 1;
// LINE 113:
_T39:
	__asm        mov    eax, reinterpret_cast<uint32_t>(temp);
	__asm        and    eax, 0xFFFF;
	__asm        xor    srandSeed, eax;
// LINE 114:
	__asm        jne    _T66;

	__asm        push   0x8C085;
	__asm        push   0x5BDFE0;
	__asm        push   0x72;
	__asm        push   0x5BDFEC;
	__asm        call   doAssert;
	__asm        add    esp, 0x10;
// LINE 115:
_T66:
	return temp;
// LINE 116:
}

// FUNCTION: COPTER_D 0x0055d717
unsigned short SRand(unsigned short lim) {
	/*bp-0x4*/   unsigned short next;


	__asm        call   GetNextRandomNumber;
	__asm        mov    next, ax;
	__asm        mov    eax, reinterpret_cast<uint32_t>(next);
	__asm        and    eax, 0xFFFF;
	__asm        mov    ecx, reinterpret_cast<uint32_t>(lim);
	__asm        and    ecx, 0xFFFF;
	__asm        cdq;
	__asm        idiv   ecx;
	__asm        mov    ax, dx;
	__asm        jmp    __RETURN;
__RETURN:
}

// FUNCTION: COPTER_D 0x0055d74a
unsigned short SRand2() {

	__asm        call   GetNextRandomNumber;
	__asm        movzx  eax, ax;
	__asm        and    eax, 1;
	__asm        jmp    __RETURN;
__RETURN:
}

// FUNCTION: COPTER_D 0x0055d765
unsigned short SRand4() {

	__asm        call   GetNextRandomNumber;
	__asm        movzx  eax, ax;
	__asm        and    eax, 3;
	__asm        jmp    __RETURN;
__RETURN:
}

// FUNCTION: COPTER_D 0x0055d780
unsigned short SRand8() {

	__asm        call   GetNextRandomNumber;
	__asm        movzx  eax, ax;
	__asm        and    eax, 7;
	__asm        jmp    __RETURN;
__RETURN:
}

// FUNCTION: COPTER_D 0x0055d79b
unsigned short SRand16() {

	__asm        call   GetNextRandomNumber;
	__asm        movzx  eax, ax;
	__asm        and    eax, 0xF;
	__asm        jmp    __RETURN;
__RETURN:
}

// FUNCTION: COPTER_D 0x0055d7b6
unsigned short SRand32() {

	__asm        call   GetNextRandomNumber;
	__asm        movzx  eax, ax;
	__asm        and    eax, 0x1F;
	__asm        jmp    __RETURN;
__RETURN:
}

// FUNCTION: COPTER_D 0x0055d7d1
unsigned short SRand64() {

	__asm        call   GetNextRandomNumber;
	__asm        movzx  eax, ax;
	__asm        and    eax, 0x3F;
	__asm        jmp    __RETURN;
__RETURN:
}

// FUNCTION: COPTER_D 0x0055d7ec
unsigned short SRand128() {

	__asm        call   GetNextRandomNumber;
	__asm        movzx  eax, ax;
	__asm        and    eax, 0x7F;
	__asm        jmp    __RETURN;
__RETURN:
}

// FUNCTION: COPTER_D 0x0055d807
unsigned short SRand256() {

	__asm        call   GetNextRandomNumber;
	__asm        movzx  eax, ax;
	__asm        and    eax, 0xFF;
	__asm        jmp    __RETURN;
__RETURN:
}

// FUNCTION: COPTER_D 0x0055d824
unsigned short SGIRand(unsigned short limit) {
	/*bp-0x4*/   unsigned short x;
	/*bp-0x8*/   unsigned short z;

// LINE 135:
	z = SRand(reinterpret_cast<uint32_t>(limit));
// LINE 136:
	x = SRand(reinterpret_cast<uint32_t>(limit));
// LINE 137:
	__asm        mov    eax, reinterpret_cast<uint32_t>(z);
	__asm        and    eax, 0xFFFF;
	__asm        mov    ecx, reinterpret_cast<uint32_t>(x);
	__asm        and    ecx, 0xFFFF;
	__asm        cmp    eax, ecx;
	__asm        jle    _T50;
// LINE 138:
	return z;
// LINE 139:
	__asm        jmp    __RETURN;
// LINE 140:
_T50:
	return x;
// LINE 141:
__RETURN:
}

// FUNCTION: COPTER_D 0x0055d882
unsigned short SGRand(unsigned short limit) {
	/*bp-0x4*/   unsigned short x;
	/*bp-0x8*/   unsigned short z;

// LINE 150:
	z = SRand(reinterpret_cast<uint32_t>(limit));
// LINE 151:
	x = SRand(reinterpret_cast<uint32_t>(limit));
// LINE 152:
	__asm        mov    eax, reinterpret_cast<uint32_t>(z);
	__asm        and    eax, 0xFFFF;
	__asm        mov    ecx, reinterpret_cast<uint32_t>(x);
	__asm        and    ecx, 0xFFFF;
	__asm        cmp    eax, ecx;
	__asm        jge    _T50;
// LINE 153:
	return z;
// LINE 154:
	__asm        jmp    __RETURN;
// LINE 155:
_T50:
	return x;
// LINE 156:
__RETURN:
}

// FUNCTION: COPTER_D 0x0055d8e0
short SGSRand(unsigned short limit) {
	/*bp-0x4*/   short x;
	/*bp-0x8*/   short z;

// LINE 165:
	z = SRand(reinterpret_cast<uint32_t>(limit));
// LINE 166:
	x = SRand(reinterpret_cast<uint32_t>(limit));
// LINE 167:
	__asm        movsx  eax, z;
	__asm        movsx  ecx, x;
	__asm        cmp    eax, ecx;
	__asm        jge    _T41;
// LINE 168:
	x = z;
// LINE 169:
_T41:
	__asm        call   SRand2;
	__asm        movzx  eax, ax;
	__asm        test   eax, eax;
	__asm        je     _T5b;
// LINE 170:
	__asm        movsx  eax, x;
	__asm        neg    eax;
	__asm        mov    x, ax;
// LINE 171:
_T5b:
	return x;
// LINE 172:
}



// Contribution: 3:00026fdc-00027008 Module: 193, 4 byte alignment, initialized_data, read, write, 
// GLOBAL: COPTER_D 0x005bdfdc
static /*unpacked*/ union __unnamed rrandSeed = { 0 /* todo */ };



// Contribution: 3:000a06a8-000a06ab Module: 193, 4 byte alignment, uninitialized_data, read, write, 
// GLOBAL: COPTER_D 0x006376a8
static unsigned long srandSeed;

